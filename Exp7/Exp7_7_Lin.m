% Linear version of Exp7.7, Page 171. Li Zhen, Apr. 23rd, 2014.

Data = [0.7171	0.0910	4.8179;
        0.8964	0.2543	4.9873;
        1.0202	0.3121	5.1282;
        1.1962	0.3792	5.2783;
        1.4928	0.4754	5.4334;
        1.6909	0.4410	5.5329;
        1.8548	0.4517	6.4749;
        2.1618	0.5595	6.5491;
        2.6638	0.8080	6.6152;
        3.4634	1.3072	6.6808;
        4.6759	1.7042	6.7455;
        5.8478	2.0019	6.8065;
        6.7885	2.2914	6.8950;
        7.4463	2.4941	6.9820;
        7.8345	2.8406	7.0637;
        8.2068	2.9854	7.1394;
        9.9468	3.2918	7.2085;
        9.7315	3.7314	7.3025;
        10.4791	4.3500	7.3740];

Q = Data(:, 1);
K = Data(:, 2);
L = Data(:, 3);

[row col] = size(Data);

C = [ones(row, 1) log(K) log(L)];
D = log(Q);

% log(a)+ alpha * log(K) + beta * log(L)
[x norm] = lsqlin(C, D, [0 1 1], 2, [], [], [0 0 0], [50 1 1]);
norm
x(1) = exp(x(1));
x

plot(log(Q), '*');
hold on;
fv = log(x(1)) .* ones(row, 1) + x(2) .* log(K) + x(3) .* log(L);
plot(fv);

fv2 = x(1) .* (K .^ x(2)) .* (L .^ x(3));
fv2 = (fv2 - Q) .^ 2;
sum(fv2)