% Exp7.5, Page 170. Li Zhen, Apr. 22nd, 2014.

X0 = ones(1, 48);
X0(1, 1:2) = zeros(1, 2);
X0(1, 25:26) = zeros(1, 2);

Data = [4 1 0.9607; 5 4 0.4758; 18 8 0.8363; 15 13 0.5725;
       12 1 0.4399; 12 4 1.3402; 13 9 0.3208; 19 13 0.7660;
       13 1 0.8143; 24 4 0.7006; 15 9 0.1574; 15 14 0.4394;
       17 1 1.3765; 8 6 0.4945; 22 9 1.2736; 16 14 1.0952;
       21 1 1.2722; 13 6 1.0559; 11 10 0.5781; 20 16 1.0422;
       5 2 0.5294; 19 6 0.6810; 13 10 0.9254; 23 16 1.8255;
       16 2 0.6144; 25 6 0.3587; 19 10 0.6401; 18 17 1.4325;
       17 2 0.3766; 8 7 0.3351; 20 10 0.2467; 19 17 1.0851;
       25 2 0.6893; 14 7 0.2878; 22 10 0.4727; 20 19 0.4995;
       5 3 0.9488; 16 7 1.1346; 18 11 1.3840; 23 19 1.2277;
       20 3 0.8000; 20 7 0.3870; 25 11 0.4366; 24 19 1.1271;
       21 3 1.1090; 21 7 0.7511; 15 12 1.0307; 23 21 0.7060;
       24 3 1.1432; 14 8 0.4439; 17 12 1.3904; 23 22 0.8052];
   
[x fv] = fminunc(@Exp7_5_Distance_2, X0);
fv
reshape(x, 2, 24)'

xx = [0 x(1:24)];
yy = [0 x(25:48)];
[row col] = size(Data); 
out = zeros(row, 1);

I = Data(:, 1);
J = Data(:, 2);
Dis = Data(:, 3);

plot(Dis, 'b*');
hold on;
for r = 1:row
    out(r) = sqrt((xx(I(r)) - xx(J(r))) ^ 2 + (yy(I(r)) - yy(J(r))) ^ 2);
end
plot(out, 'r.');

stemplot((Dis - out) ./ mean(Dis));